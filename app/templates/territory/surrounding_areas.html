<div class="col col-md-12">

    <div class="table-responsive table-responsive-sm">
        <table id="surroundingAreasTable" class="table table-striped table-hover table-sm">
            <thead class="thead-dark">
            <tr>
                <th><i class="fas fa-plus-circle"></i></th>
                <th>Type</th>
                <th>Code</th>
                <th>Nom</th>
                <th>Nombre d'observations</th>
                <th>Nombre de taxons</th>
                <th>Nombre de taxons menacés</th>
                <th>Nombre d'observateurs</th>
                <th>Nombre de dates</th>
                <th>Dernière observation</th>
                <th>Nombre de jeux de données</th>
            </tr>
            </thead>
        </table>
    </div>
</div>
{#<div class="col col-md-6">#}
{#    <div id="surroundingAreasMap" class="card"></div>#}
{#</div>#}
<script>
    var surroundingAreasTable = $("#surroundingAreasTable").DataTable({
            ajax: {
                url: '/api/surrounding_areas/{{ area_info.type_code }}/{{ area_info.area_code }}',
                dataSrc: ""
            },
            scrollY: '300px',
            scrollCollapse: true,
            paging: false,
            language: {
                "sEmptyTable": "Aucune donnée disponible dans le tableau",
                "sInfo": "Affichage de l'élément _START_ à _END_ sur _TOTAL_ éléments",
                "sInfoEmpty": "Affichage de l'élément 0 à 0 sur 0 élément",
                "sInfoFiltered": "(filtré à partir de _MAX_ éléments au total)",
                "sInfoPostFix": "",
                "sInfoThousands": ",",
                "sLengthMenu": "Afficher _MENU_ éléments",
                "sLoadingRecords": "Chargement...",
                "sProcessing": "Traitement...",
                "sSearch": "Rechercher :",
                "sZeroRecords": "Aucun élément correspondant trouvé",
                "oAria": {
                    "sSortAscending": ": activer pour trier la colonne par ordre croissant",
                    "sSortDescending": ": activer pour trier la colonne par ordre décroissant"
                },
            },
            columns: [
                {
                    data: function (row) {
                        return '<a href="/territory/' + row.type_code + '/' + row.area_code + '" target="_blank" title="Voir la fiche de ' + row.area_name + '" data-toogle="tooltips"><i class="fa fa-fw fa-link text-info"></i></a>'
                    }
                },
                {data: "type_desc"},
                {data: "area_code"},
                {data: "area_name"},
                {data: "count_occtax"},
                {data: "count_taxa"},
                {data: "count_threatened"},
                {data: "count_observer"},
                {data: "count_date"},
                {
                    data: function (row) {
                        return new Date(row.last_obs).toLocaleDateString();
                    }
                },
                {data: "count_dataset"},
            ],
        })
    ;
    {#var surroundingAreasMap = baseMap('surroundingAreasMap');#}
    {##}
    {#var surroundingArea = null;#}
    {##}
    {#$('#surroundingAreasTable').on('click', 'tr', function () {#}
    {#    type_code = $(this).data("typecode");#}
    {#    area_code = $(this).data("areacode");#}
    {#    console.log(surroundingAreasMap.hasLayer(surroundingArea));#}
    {#    if (surroundingAreasMap.hasLayer(surroundingArea)) {#}
    {#        console.log('removeLayer');#}
    {#        surroundingAreasMap.removeLayer(surroundingArea);#}
    {#    };#}
    {#    axios#}
    {#        .get('/api/geom/' + type_code + '/' + area_code)#}
    {#        .then(function (response) {#}
    {#            var surroundingArea = L.geoJson(response.data, {#}
    {#                style: territoryStyle#}
    {#            });#}
    {#            surroundingAreasMap.addLayer(surroundingArea);#}
    {#            surroundingAreasMap.flyToBounds(surroundingArea.getBounds());#}
    {##}
    {#        })#}
    {#        .catch(function (error) {#}
    {#            console.log('<getTerritoryArea> Error', error);#}
    {#        });#}
    {#})
    ;
    #}


</script>